# Protein Generator


This repository is intended to capture a set of machine learning tools that would be helpful for people who want to build generative models for protein structures. 

These tools are going to split into model architectures (nn), datasets (different featurizations of PDB files), and losses.

Users of this library will be able to make different training regimens to train generative models that generate 3D protein coordinates. There might be other use cases for the utilities provided but I am optimizing it to make training generative models easy (VAEs, GANs, GMMs, Contrastive Loss models). 

Feel free to open an issue/PR if there's anything you would want added!

## Background

Many different biological molecules have been used for drugs over the years, most commonly small molecules and proteins. There are an extensive set of protein drugs that are on already FDA approved, most of which are antibodies. These are often discovered by immunizing animals with target antigens and harvesting their antibodies. These antibodies go through extensive rounds of engineering such as making them more human-like, improving their affinity to the target and improving their biophysical properties for pharmacokinetics and manufacturing purposes. Despite many successes, these efforts often end in failure or with antibodies with liabilities entering the clinic. 

Generative models have been proposed for proteins before, mostly to model the joint probability of a sequence and it's structure or folding capacity. Proteins designed using machine learning have been previously observed to be extremely stable and have high melting temperatures which could correlate to better clinical properties. There have been some early efforts to conditionaly generate proteins based on their function, including a successfully crystallized protein generated by a language model (Madani 2021) but this is still mostly an open problem. This repository is intended to accelerate this line of research.  

In the past years, methods such as AlphaFold and RoseTTAFold have shown that neural networks can reason on protein inputs in 3D space. This is because neural networks have been developed that are rotationally and translationally invariant. Just as convolutions were powerful for images because they are translationally invariant, these networks are extremely powerful for proteins because proteins are 3D objects in space that could be rotated or translated without changing their identity. These advances lead me to think that these network architectures can be used to build generative models that can make de novo proteins. 

## Ideas for additions

The first application of this repository is to enable ML practitioners to develop models that directly generate 3D coordinates of proteins. Current generative modelling for proteins has focused on sequence generation or contact map generation. The introduction of 3D invariant and equivariant machine learning models has opened the possibility to train models that can be trained to directly generate 3D coordinates of proteins instead of sequences or other proxies to structure.

1. <b>New machine learning architectures.</b> While the structure refinment methods used in RoseTTAFold and AlphaFold are good starting points, there might be alternative machine learning architectures that are better for this task. This is a good example of where pushing the bounds on protein biochemistry research could move other machine learning fields forward as well.

2. <b>New training schemes.</b> I think that there will need to be some adjusted training schemes to train a generative model on a graph of proteins. Some ideas here would be to influence the generator loss using Rosetta energy to improve convergence, adding conditional inputs into the generator or using RoseTTAFold or AlphaFold to bias the discriminator. 

3. <b>New graph representations.</b> The first implementation just has one node feature which is the atom type. Other featurizations could be imagined including concepts like aromaticity or other chemical features. For generative models such as GANs there are random noise inputs, different versions of a "noise" graph could be considered or inputting a 2D noise contact map that is transformed into a graph. 
